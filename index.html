<!DOCTYPE html>
{% autoescape true %}

<html>
<head>
<meta charset="utf-8">
<title>GMaps.js &mdash; Tests</title>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
<script type="text/javascript" src="https://rawgit.com/HPNeo/gmaps/master/gmaps.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<!--<link rel="stylesheet" href="http://twitter.github.com/bootstrap/1.3.0/bootstrap.min.css" />-->
<link rel="stylesheet" type="text/css" href="https://linux.ime.usp.br/~scaroni/gmaps/example.css" />


<script type="text/javascript">
    var map;
    var myLocations;
    var possiblePlaces;
    var origem;
    var dest;
    
    $(document).ready(function(){
      possiblePlaces = [];
      {% for p in places %}
       possiblePlaces.push("{{p}}");
      {% endfor %}
      var origdropdown = "<select name=selectOrigem onchange='getOrigem(this);' required>";
      for (var op in possiblePlaces)
      {
        origdropdown = origdropdown + "<option>"+possiblePlaces[op]+"</option>";
      }
      origdropdown = origdropdown +  "</select>";
      console.log(origdropdown);
      document.getElementById("selOrig").innerHTML = origdropdown;
    });
      $("#btApend").click(
          function() {
            myLocations.push("A");
          }
        );

      $('#btSubmit').click(

        function post() {
          method = "post";
          path = "/map";

          var form = document.createElement("form");
          form.setAttribute("method", method);
          form.setAttribute("action", path);

          var hiddenField = document.createElement("input");
          hiddenField.setAttribute("type", "hidden");
          hiddenField.setAttribute("name", "locations");
          var strLocations = origem + "\t" + dest + "\t";
          for (var key in myLocations) {
              strLocations = strLocations + myLocations[key] + "\t";
          }

          hiddenField.setAttribute("value", strLocations);

          form.appendChild(hiddenField);

          document.body.appendChild(form);
          form.submit();
        }
      );   

    var origSelected = false;
    var destSelected = false;

    function ShowOtherPlaces ()
    {
          document.getElementById("myDiv").innerHTML = "blabla";
    }



    function getOrigem(dropdown) {
        var myindex  = dropdown.selectedIndex;
        var SelValue = dropdown.options[myindex].value;
        //document.getElementById("demo").innerHTML = SelValue;
        origem = SelValue;
        origSelected = true;
        if(origSelected && destSelected)
        {
          ShowOtherPlaces();
        }
        return true;
    }

    function getDest(dropdown) {
        var myindex  = dropdown.selectedIndex;
        var SelValue = dropdown.options[myindex].value;
        //document.getElementById("demo").innerHTML = SelValue;
        dest = SelValue;
        destSelected = true;
        if(origSelected && destSelected)
        {
          ShowOtherPlaces();

        }
        return true;
    }
  </script>
</head>


<body>
<button type="button" id="btApend">Apend na lista</button>

<button type="button" id="btSubmit">Submit</button>

<div id="selOrig">
  <select name=selectOrigem onchange='getOrigem(this);' required>
    <option id="dropdown0" value="" selected="selected"></option>
    <option id="dropdown1">Value 1</option>
    <option id="dropdown2">Value 2</option>
    <option id="dropdown3">Value 3</option>
  </select>
</div> 

<div>
  <select name=selectDest onchange='getDest(this);' required>
    <option id="dropdown3.5" value="" selected="selected"></option>
    <option id="dropdown4">Value 1</option>
    <option id="dropdown5">Value 2</option>
    <option id="dropdown6">Value 3</option>
  </select>
</div> 

<div id="WayPointSelection">

</div>

</body>

</html>
{% endautoescape %}
